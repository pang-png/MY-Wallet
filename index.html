<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Health Grade</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #4a90e2; --income: #2ecc71; --expense: #e74c3c; --bg: #f4f7f9; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 480px; margin: auto; background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏Å‡∏£‡∏î */
        .grade-card { padding: 25px; border-radius: 15px; text-align: center; color: white; margin-bottom: 20px; background: #999; transition: 0.5s; }
        .grade-letter { font-size: 5rem; font-weight: bold; margin: 0; }
        .advice { background: rgba(0,0,0,0.1); padding: 12px; border-radius: 10px; font-size: 0.9rem; text-align: left; margin-top: 10px; }

        .status-A { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .status-B { background: linear-gradient(135deg, #a2d240, #8eb233); }
        .status-C { background: linear-gradient(135deg, #f1c40f, #f39c12); color: #333; }
        .status-D { background: linear-gradient(135deg, #e67e22, #d35400); }
        .status-F { background: linear-gradient(135deg, #e74c3c, #c0392b); }

        .stats { display: flex; justify-content: space-around; margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 15px; }
        .stats div { text-align: center; }
        
        input, select, button { width: 100%; padding: 14px; margin: 8px 0; border-radius: 12px; border: 1px solid #ddd; font-size: 1rem; box-sizing: border-box; }
        button { background: var(--primary); color: white; border: none; font-weight: bold; cursor: pointer; border-bottom: 4px solid #357abd; }
        button:active { margin-top: 10px; border-bottom: 0; }
        
        .history { margin-top: 25px; border-top: 2px solid #eee; padding-top: 15px; }
        .item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #f0f0f0; }
    </style>
</head>
<body>

<div class="container">
    <div id="gradeBox" class="grade-card">
        <div style="font-weight: bold;">‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</div>
        <div id="gradeLetter" class="grade-letter">-</div>
        <div id="gradeLabel" style="font-size: 1.2rem; font-weight: bold;">‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
        <div id="adviceText" class="advice">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÄ‡∏Å‡∏£‡∏î‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</div>
    </div>

    <div class="stats">
        <div>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö<br><b id="totalInc" style="color:var(--income)">0</b></div>
        <div>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢<br><b id="totalExp" style="color:var(--expense)">0</b></div>
    </div>

    <div style="max-width: 200px; margin: auto;">
        <canvas id="myChart"></canvas>
    </div>

    <div style="margin-top: 20px;">
        <input type="text" id="desc" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£">
        <input type="number" id="amt" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">
        <select id="type">
            <option value="exp">üî¥ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
            <option value="inc">üü¢ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
        </select>
        <button id="addBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
    </div>

    <div id="historyList" class="history"></div>
    <button onclick="resetData()" style="background:#eee; color:#666; font-size:0.7rem; border:none; margin-top:50px;">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('my_wallet_vfinal')) || [];
    let chartObj = null;

    function render() {
        const list = document.getElementById('historyList');
        let inc = 0, exp = 0;
        list.innerHTML = '<b>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</b>';

        db.forEach(item => {
            if(item.type === 'inc') inc += item.amt; else exp += item.amt;
            list.innerHTML += `
                <div class="item">
                    <span>${item.desc}</span>
                    <b style="color:${item.type === 'inc' ? '#2ecc71' : '#e74c3c'}">
                        ${item.type === 'inc' ? '+' : '-'}${item.amt.toLocaleString()}
                    </b>
                </div>`;
        });

        document.getElementById('totalInc').innerText = inc.toLocaleString();
        document.getElementById('totalExp').innerText = exp.toLocaleString();

        updateGrade(inc, exp);
        updateChart(inc, exp);
    }

    function updateGrade(inc, exp) {
        const box = document.getElementById('gradeBox');
        const letter = document.getElementById('gradeLetter');
        const label = document.getElementById('gradeLabel');
        const advice = document.getElementById('adviceText');

        if (inc === 0) return;

        const ratio = (exp / inc) * 100;
        let g, lb, ad, cl;

        if (ratio <= 30) { g='A'; lb='‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°'; cl='status-A'; ad='üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á: ‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏ô‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î'; }
        else if (ratio <= 50) { g='B'; lb='‡∏î‡∏µ'; cl='status-B'; ad='üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á: ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡∏Ñ‡∏ß‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô'; }
        else if (ratio <= 75) { g='C'; lb='‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á'; cl='status-C'; ad='‚ö†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡∏≠‡∏≠‡∏°‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏î‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ü‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏∑‡∏≠‡∏¢‡∏≠‡∏≠‡∏Å 10%'; }
        else if (ratio <= 95) { g='D'; lb='‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢'; cl='status-D'; ad='üö® ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏ä‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î'; }
        else { g='F'; lb='‡∏ß‡∏¥‡∏Å‡∏§‡∏ï'; cl='status-F'; ad='‚ùå ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï: ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡πà‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏£‡∏µ‡∏ö‡∏à‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ'; }

        box.className = 'grade-card ' + cl;
        letter.innerText = g;
        label.innerText = lb + ' (‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ' + ratio.toFixed(0) + '%)';
        advice.innerText = ad;
    }

    function updateChart(inc, exp) {
        const ctx = document.getElementById('myChart').getContext('2d');
        if (chartObj) chartObj.destroy();
        chartObj = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['‡∏£‡∏±‡∏ö', '‡∏à‡πà‡∏≤‡∏¢'],
                datasets: [{ data: [inc || 1, exp], backgroundColor: ['#2ecc71', '#e74c3c'] }]
            },
            options: { plugins: { legend: { display: false } } }
        });
    }

    document.getElementById('addBtn').onclick = function() {
        const d = document.getElementById('desc').value;
        const a = parseFloat(document.getElementById('amt').value);
        const t = document.getElementById('type').value;

        if(!d || !a) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'); return; }

        db.unshift({ desc: d, amt: a, type: t });
        localStorage.setItem('my_wallet_vfinal', JSON.stringify(db));
        
        document.getElementById('desc').value = '';
        document.getElementById('amt').value = '';
        render();
    };

    function resetData() { if(confirm('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) { db = []; localStorage.removeItem('my_wallet_vfinal'); render(); } }

    window.onload = render;
</script>

</body>
</html>
