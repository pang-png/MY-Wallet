<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Grade Wallet</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #4a90e2; --income: #2ecc71; --expense: #e74c3c; --bg: #f4f7f9; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .container { max-width: 480px; margin: auto; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏Å‡∏£‡∏î */
        .grade-card { padding: 25px; border-radius: 15px; text-align: center; color: white; margin-bottom: 20px; background: #999; transition: 0.5s; }
        .grade-letter { font-size: 5rem; font-weight: bold; margin: 0; }
        .advice { background: rgba(0,0,0,0.1); padding: 12px; border-radius: 10px; font-size: 0.9rem; text-align: left; margin-top: 10px; }

        .status-A { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        .status-B { background: linear-gradient(135deg, #a2d240, #8eb233); }
        .status-C { background: linear-gradient(135deg, #f1c40f, #f39c12); color: #333; }
        .status-D { background: linear-gradient(135deg, #e67e22, #d35400); }
        .status-F { background: linear-gradient(135deg, #e74c3c, #c0392b); }

        .stats { display: flex; justify-content: space-around; margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 15px; }
        .stats div { text-align: center; }
        
        input, select, button { width: 100%; padding: 14px; margin: 8px 0; border-radius: 12px; border: 1px solid #ddd; font-size: 1rem; box-sizing: border-box; outline: none; }
        input:focus { border-color: var(--primary); }
        button { background: var(--primary); color: white; border: none; font-weight: bold; cursor: pointer; border-bottom: 4px solid #357abd; }
        button:active { border-bottom: 0; transform: translateY(4px); }
        
        .history { margin-top: 25px; border-top: 2px solid #eee; padding-top: 15px; }
        .item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #f0f0f0; align-items: center; }
        .del-btn { width: auto; padding: 5px 10px; background: #ff4d4d1a; color: #ff4d4d; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="container">
    <div id="gradeBox" class="grade-card">
        <div style="font-weight: bold;">‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</div>
        <div id="gradeLetter" class="grade-letter">-</div>
        <div id="gradeLabel" style="font-size: 1.2rem; font-weight: bold;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
        <div id="adviceText" class="advice">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</div>
    </div>

    <div class="stats">
        <div>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö<br><b id="totalInc" style="color:var(--income)">0</b></div>
        <div>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢<br><b id="totalExp" style="color:var(--expense)">0</b></div>
    </div>

    <div style="max-width: 180px; margin: auto;">
        <canvas id="myChart"></canvas>
    </div>

    <div style="margin-top: 20px;">
        <input type="text" id="desc" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£)">
        <input type="text" id="amt" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" oninput="formatNumber(this)">
        <select id="type">
            <option value="exp">üî¥ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
            <option value="inc">üü¢ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
        </select>
        <button id="addBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
    </div>

    <div id="historyList" class="history"></div>
    <button onclick="resetData()" style="background:none; color:#bbb; border:none; margin-top:40px; font-size:0.7rem; border-bottom:1px solid #eee;">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ</button>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('my_wallet_v5')) || [];
    let chartObj = null;

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ç‡∏ì‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå
    function formatNumber(input) {
        let value = input.value.replace(/\D/g, ""); // ‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
        input.value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ","); // ‡πÉ‡∏™‡πà‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤
    }

    function render() {
        const list = document.getElementById('historyList');
        let inc = 0, exp = 0;
        list.innerHTML = '<b>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</b>';

        db.forEach((item, index) => {
            if(item.type === 'inc') inc += item.amt; else exp += item.amt;
            list.innerHTML += `
                <div class="item">
                    <span>${item.desc}</span>
                    <div style="text-align:right">
                        <b style="color:${item.type === 'inc' ? '#2ecc71' : '#e74c3c'}">
                            ${item.type === 'inc' ? '+' : '-'}${item.amt.toLocaleString()}
                        </b>
                        <br><span onclick="deleteItem(${index})" style="color:#ccc; font-size:0.7rem; cursor:pointer">‡∏•‡∏ö</span>
                    </div>
                </div>`;
        });

        document.getElementById('totalInc').innerText = inc.toLocaleString();
        document.getElementById('totalExp').innerText = exp.toLocaleString();

        updateGrade(inc, exp);
        updateChart(inc, exp);
    }

    function updateGrade(inc, exp) {
        const box = document.getElementById('gradeBox');
        const letter = document.getElementById('gradeLetter');
        const label = document.getElementById('gradeLabel');
        const advice = document.getElementById('adviceText');

        if (inc === 0) return;

        const ratio = (exp / inc) * 100;
        let g, lb, ad, cl;

        if (ratio <= 35) { g='A'; lb='‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°'; cl='status-A'; ad='üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á: ‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≠‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì'; }
        else if (ratio <= 50) { g='B'; lb='‡∏î‡∏µ'; cl='status-B'; ad='üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á: ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° ‡∏Ñ‡∏ß‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 3-6 ‡πÄ‡∏ó‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢'; }
        else if (ratio <= 75) { g='C'; lb='‡∏û‡∏≠‡πÉ‡∏ä‡πâ'; cl='status-C'; ad='‚ö†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ‡∏≠‡∏≠‡∏°‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏ô‡∏¥‡∏î ‡∏•‡∏≠‡∏á‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≠‡∏Å‡∏™‡∏±‡∏Å 10% ‡∏î‡∏π‡∏Ñ‡∏£‡∏±‡∏ö'; }
        else if (ratio <= 95) { g='D'; lb='‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á'; cl='status-D'; ad='üö® ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏≠‡∏° ‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏´‡∏£‡∏π‡∏ó‡∏±‡∏ô‡∏ó‡∏µ'; }
        else { g='F'; lb='‡∏ß‡∏¥‡∏Å‡∏§‡∏ï'; cl='status-F'; ad='‚ùå ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï: ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏£‡∏µ‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ü‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏∑‡∏≠‡∏¢‡∏î‡πà‡∏ß‡∏ô'; }

        box.className = 'grade-card ' + cl;
        letter.innerText = g;
        label.innerText = lb + ' (‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ' + ratio.toFixed(0) + '%)';
        advice.innerText = ad;
    }

    function updateChart(inc, exp) {
        const ctx = document.getElementById('myChart').getContext('2d');
        if (chartObj) chartObj.destroy();
        chartObj = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö', '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢'],
                datasets: [{ 
                    data: [inc || 1, exp], 
                    backgroundColor: ['#2ecc71', '#e74c3c'],
                    borderWidth: 0
                }]
            },
            options: { 
                plugins: { legend: { display: false } },
                cutout: '80%'
            }
        });
    }

    document.getElementById('addBtn').onclick = function() {
        const d = document.getElementById('desc').value;
        const rawAmt = document.getElementById('amt').value.replace(/,/g, "");
        const a = parseFloat(rawAmt);
        const t = document.getElementById('type').value;

        if(!d || isNaN(a)) { alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô'); return; }

        db.unshift({ desc: d, amt: a, type: t });
        localStorage.setItem('my_wallet_v5', JSON.stringify(db));
        
        document.getElementById('desc').value = '';
        document.getElementById('amt').value = '';
        render();
    };

    function deleteItem(index) {
        if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?')) {
            db.splice(index, 1);
            localStorage.setItem('my_wallet_v5', JSON.stringify(db));
            render();
        }
    }

    function resetData() { 
        if(confirm('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ?')) { 
            db = []; localStorage.removeItem('my_wallet_v5'); 
            render(); 
        } 
    }

    window.onload = render;
</script>

</body>
</html>
